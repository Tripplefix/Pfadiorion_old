(function(b){b.fn.parallax=function(a){var x=b.extend({placeHolderName:".parallax",parallax:0.75},a);var s=new Array(),v=new Array(),r=0,A=b(window),B=document,t=b(".parallax"),z=b("body"),w=parseInt(A.width()),y=parseInt(A.height()),p=b(B.createElement("div"));p.addClass("parallax_parent");z.prepend(p);t.each(function(i,k){var l=b(k),d=parseInt(l.data("height")),e=parseInt(l.data("with")),j=l.data("image"),g=l.offset().top-A.scrollTop(),f=l.data("container-height");s[i]=0;v[i]=-l.data("posy");r=l.data("posy");b(x.placeHolderName).css({height:f,width:"100%"});if(w>=e){s[i]=0;e=e+(w-e);d=d*(w/e)}else{s[i]=(w-e)/2}var h=b(B.createElement("div"));h.addClass("parallax_container");h.css({visibility:"visible",height:f,transform:"translate3d(0px, "+g+"px, 0px)","-webkit-transform":"translate3d(0px, "+g+"px, 0px)"});var c=b(B.createElement("div"));c.addClass("parallax_image");c.css({backgroundImage:"url('"+j+"')",width:e,height:d,transform:"translate3d("+s[i]+"px, "+(-(g)*x.parallax-r)+"px, 0px)","-webkit-transform":"translate3d("+s[i]+"px, "+(-(g)*x.parallax-r)+"px, 0px)"});h.append(c);p.append(h)});var u=b(".parallax_container"),q=b(".parallax_image");A.resize(function(){w=parseInt(A.width());y=parseInt(A.height());q.each(function(e,c){var d=b(c),f=parseInt(b(t.get(e)).data("with")),g=parseInt(b(t.get(e)).data("height"));if(w>=f){s[e]=0;f=f+(w-f);g=g*(w/f)}else{s[e]=(w-f)/2}d.css({width:f,height:g,transform:"translate3d("+s[e]+"px, "+v[e]+"px, 0px)","-webkit-transform":"translate3d("+s[e]+"px, "+v[e]+"px, 0px)"})});u.each(function(e,c){var d=b(c);d.css({height:b(t[e]).data("container-height")})})});A.scroll(function(){var c=A.scrollTop(),d=y+c;u.css({visibility:"hidden",transform:"translate3d(0px, 0px, 0px)","-webkit-transform":"translate3d(0px, 0px, 0px)"});t.each(function(h,e){var g=b(e),l=g.offset().top,j=(l-c),i="visible",k=b(u.get(h)),f=g.data("container-height");if((d)>=l){if((c-l)>=f){j=0;i="hidden"}k.css({visibility:i,transform:"translate3d(0px, "+j+"px, 0px)","-webkit-transform":"translate3d(0px, "+j+"px, 0px)"});v[h]=(-(j)*x.parallax-r);k.children().first().css({transform:"translate3d("+s[h]+"px, "+v[h]+"px, 0px)","-webkit-transform":"translate3d("+s[h]+"px, "+v[h]+"px, 0px)"})}})});return this}}(jQuery));